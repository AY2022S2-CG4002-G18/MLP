from pynq import Overlay, allocate

ol = Overlay("./mlp.bit")
dma = ol.axi_dma_0

input_buffer = allocate(shape=(276,), dtype=np.float32)
output_buffer = allocate(shape=(4,), dtype=np.float32)

temp1 = [1086, 13656, -11826, -12720, -55, 915, -4042, -2729, -2610, 3321, 9982, 11970, -2926, -9147, 2389, -2375, 36, -2001, -3935, -1925, -2454, -2009, -3447, -8404, -11140, -14449, -20114, -9279, -383, 1861, -500, -2697, -1754, -958, -276, 247, 336, 191, -138, -233, 22, 362, 417, -69, -183, -99, -2160, -2144, -2176, -2176, -2160, -2176, -2160, -2176, -2144, -2144, -2176, -2160, -2160, -2160, -2144, -2176, -2176, -2144, -2160, -2128, -2192, -2144, -2176, -2176, -2160, -2160, -2176, -2144, -2176, -2160, -2128, -2176, -2176, -2176, -2160, -2160, -2144, -2144, -2176, -2160, -2160, -2176, -2176, -2144, -2192, -2160, -14064, 27340, -21250, 1273, 2023, 3037, -8809, 1063, -2936, 9200, 19926, -32599, 11367, -4500, -6941, -4285, -7326, -13334, -16993, -23345, -27057, -22028, -21431, -15834, -12606, -17167, -14056, -17766, 3120, 4217, -524, -6004, -3781, 180, -8, -695, -521, 281, -387, -599, 89, 425, 114, -416, -371, -354, 13874, 1586, 550, 5626, 9950, 4326, 5074, -5666, -5286, -7014, -12366, -20662, -19870, -12998, -11466, -10650, -9218, -9982, -9826, -8614, -7234, -6238, -5826, -3330, -14, 2822, 8558, 34, -1390, -942, -1058, -1318, -1570, -1278, -398, -782, -1066, -1310, -946, -970, -950, -1122, -1322, -1286, -1206, -1198, 21944, 16372, 14928, 14228, 19112, 15136, 9952, 8912, 10004, 8316, 3848, 10324, 23928, 25080, 21896, 19808, 17552, 17544, 14448, 13344, 13420, 9304, 9448, 7192, 9808, 5320, 8292, -1040, -832, 5300, 5472, 3984, 1780, 1900, 3252, 3184, 2356, 2780, 3180, 2856, 2852, 3084, 3500, 3140, 2972, 3064, 5164, 7576, 13864, 9176, 5584, 7664, 5556, 5540, 7836, 5072, 5296, 3888, 13228, 4784, 3516, 5976, 2252, 4440, 3292, 6000, 6992, 8516, 9724, 10596, 14180, 13728, 32767, 11716, 18744, 17136, 17776, 17736, 17972, 18092, 17592, 17880, 17980, 18080, 17876, 17856, 17820, 17748, 17848, 17948, 17808, 17724]
np_input = np.array([temp1])
input_buffer[:] = np_input

dma.sendchannel.transfer(input_buffer)
dma.recvchannel.transfer(output_buffer)
dma.sendchannel.wait()
dma.recvchannel.wait()
output_buffer